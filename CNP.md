### CNP(contract net protocol)
Contract Net Protocol(CNP)은 자율 에이전트들이 중앙 스케줄러의 직접적인 통제를 받지 않고, 입찰과 협상 과정을 통해 작업을 할당하는 절차를 표준화한 분산 협상 기반 프로토콜이다.

CNP의 사용이유
동적 작업 할당: 에이전트의 현재 상태와 능력에 따라 어떤 에이전트가 작업을 진행할지 유연하게 분배
분산 의사결정: 중앙 집중식이 아니기 때문에 중앙 서버에 구애받지않고 에이전트 스스로가 작업에 적합한지 판단후 입찰
장애 대응: 한 에이전트가 실패하면 다른 에이전트에게 재할당 가능
최적화: 다양한 기준으로 통해 작업에 최적의 에이전트에게 작업을 할당

CNP의 한계
여러 에이전트에게 작업 요청 메세지를 보냈을 경우 모든 에이전트로 부터 제안을 받을 때 까지 대기하거나 최적의 제안을 계산하는데 걸리는 시간이 있음
에이전트의 불확실성, 제안과정에서 에이전트가 가능하다 했지만 작업과정에서 문제가 발생했을 경우 사후 처리 비용발생
하나의 작업을 위해 여러번의 메세지가 오고 가야하기 때문에 작업에 참여하는 에이전트가 많을수록 네트워크 트래픽의 증가

### 중앙 스케줄러와 CNP(Contract Net Protocol) 비교

분산 시스템에서 작업을 여러 에이전트에게 분배하는 방식은 크게 중앙 스케줄러 방식과 CNP(Contract Net Protocol) 방식으로 구분할 수 있다.
두 방식은 서로 대체 관계라기보다는, 시스템이 가정하는 전제 조건과 운영 환경에 따라 선택되는 구조이다.

CNP에서 Manager 에이전트는 Contractor 에이전트들로부터 제안을 수집한 후, 그중 하나를 선택하여 작업을 위임한다. 이 과정에서 Manager 에이전트가 중앙 스케줄러처럼 동작하는 것이 아닌가 하는 의문이 제기될 수 있다.
그러나 중앙 스케줄러는 시스템 전체의 작업을 상시적으로 관리하며, 모든 자원 노드로부터 자원 상태를 주기적으로 보고받아 전역 상태 정보를 유지한다. 또한 작업을 강제로 할당할 수 있으며, 의사결정 권한이 중앙에 고정되어 있다.

반면 CNP의 Manager 에이전트는 Contractor 에이전트들의 자원 상태를 직접적으로 파악하지 못하며, 입찰을 통해 자발적으로 제공된 정보만을 기반으로 의사결정을 수행한다. 작업 또한 강제 할당되지 않으며, Contractor 에이전트는 제안 제출 여부와 제안 내용에 대해 자율적인 의사결정 권한을 가진다.
즉, 최종 선택은 Manager 에이전트가 수행하지만, 작업 분배 과정 전반은 협상 기반의 분산 의사결정 구조로 이루어진다는 점에서 중앙 스케줄러와 본질적인 차이를 가진다.

### 중앙 스케줄러 방식이 적합한 경우

중앙 스케줄러는 하나의 중앙 노드가 모든 에이전트의 상태를 파악하고, 작업을 직접 할당하는 구조이다. 다음과 같은 조건이 충족될 때 효과적이다.
중앙 스케줄러가 모든 에이전트의 상태(부하, 능력, 자원)를 정확하고 신뢰성 있게 파악할 수 있는 경우
작업의 수행 시간과 비용이 예측 가능하고 정형화된 경우
작업 할당에 대한 지연(latency)이 최소화되어야 하는 실시간 시스템
에이전트 수가 제한적이며, 중앙 노드가 병목이 되지 않는 규모의 시스템
이러한 환경에서는 작업 요청, 제안, 협상과 같은 추가적인 통신 과정이 필요 없기 때문에
처리 속도가 빠르고 구현이 단순하다는 장점이 있다.

### CNP(Contract Net Protocol)가 필요한 경우

CNP는 중앙 통제 없이, 에이전트들이 협상을 통해 자율적으로 작업을 분배하는 프로토콜이다.
다음과 같은 상황에서 중앙 스케줄러의 한계를 보완한다.
중앙에서 모든 에이전트의 상태를 완벽하게 파악하기 어려운 경우
에이전트의 능력이나 상태가 동적으로 변화하는 환경
작업 수행 가능 여부를 에이전트 스스로 판단해야 하는 경우
작업 실패 가능성이 존재하며, 재할당이 자주 필요한 시스템
대규모 분산 환경에서 중앙 노드의 병목이나 단일 장애 지점(SPOF)을 피해야 하는 경우
CNP는 통신 비용과 협상 지연이라는 오버헤드가 있지만,
그 대신 유연성, 확장성, 장애 대응 능력을 제공한다.

### 계층형 CNP
계층형 Contract Net Protocol은 CNP의 Manager–Contractor 구조에서 발생하는 의사결정 병목과 네트워크 혼잡을 완화하기 위해 등장하였다. 기존 CNP에서는 하나의 Manager 에이전트가 다수의 Contractor 에이전트와 직접 통신하며
모든 제안을 수집·비교해야 했으나, 계층형 CNP에서는 하나의 최상위 Manager와 여러 하위 Manager 에이전트로 구성된 계층 구조를 도입한다. 하위 Manager 에이전트는 자신이 관리하는 Contractor 에이전트들과 CNP를 수행한 후,
로컬 의사결정 결과 또는 요약된 정보를 최상위 Manager에게 전달함으로써 통신 범위와 의사결정 부담을 분산시킨다. 그러나 최종 의사결정이 최상위 Manager에 집중되기 때문에 병목이 완전히 제거되진 않으며, 이를 해결하기 위해 
Market-based coordination이나 분산 경매 방식이 제안되었다.

