### CNP(contract net protocol)
중앙 통제를 받지않는 자율 에이전트들이 협상을 통해 작업을 분배하는 과정을 표준화한 프로토콜

CNP의 흐름
작업 요청: 작업 요청자가 수행해야 할 작업에 대해 다른 자율 에이전트에게 작업 요청을 보냄
제안: 요청을 받은 자율 에이전트는 해당 작업을 수행 할 수 있는 조건이나 계획을 담은 제안을 반환
선택 및 거절: 작업 요청자는 들어온 제안을 검토 후 적합하지 않은 제안이면 거절 적합하다면 채택
수행 및 완료: 작업을 할당 받은 에이전트가 작업 수행후 결과를 보고
결과 확인 및 처리: 작업완료 보고를 받은 후, 작업 결과에 대해 만족스럽지 않거나 문제가 발생한 경우 실패 처리

CNP의 사용이유
동적 작업 할당: 에이전트의 현재 상태와 능력에 따라 어떤 에이전트가 작업을 진행할지 유연하게 분배
분산 의사결정: 중앙 집중식이 아니기 때문에 중앙 서버에 구애받지않고 에이전트 스스로가 작업에 적합한지 판단후 입찰
장애 대응: 한 에이전트가 실패하면 다른 에이전트에게 재할당 가능
최적화: 다양한 기준으로 통해 작업에 최적의 에이전트에게 작업을 할당

CNP의 한계
여러 에이전트에게 작업 요청 메세지를 보냈을 경우 모든 에이전트로 부터 제안을 받을 때 까지 대기하거나 최적의 제안을 계산하는데 걸리는 시간이 있음
에이전트의 불확실성, 제안과정에서 에이전트가 가능하다 했지만 작업과정에서 문제가 발생했을 경우 사후 처리 비용발생
하나의 작업을 위해 여러번의 메세지가 오고 가야하기 때문에 작업에 참여하는 에이전트가 많을수록 네트워크 트래픽의 증가

### 중앙 스케줄러와 CNP(Contract Net Protocol) 비교 정리

분산 시스템에서 작업을 여러 에이전트에게 분배하는 방식은 크게 중앙 스케줄러 방식과 CNP(Contract Net Protocol) 방식으로 나눌 수 있다.
두 방식은 서로 대체 관계라기보다는, 시스템의 전제 조건과 환경에 따라 선택되는 구조이다.

### 중앙 스케줄러 방식이 적합한 경우

중앙 스케줄러는 하나의 중앙 노드가 모든 에이전트의 상태를 파악하고, 작업을 직접 할당하는 구조이다. 다음과 같은 조건이 충족될 때 효과적이다.
중앙 스케줄러가 모든 에이전트의 상태(부하, 능력, 자원)를 정확하고 신뢰성 있게 파악할 수 있는 경우
작업의 수행 시간과 비용이 예측 가능하고 정형화된 경우
작업 할당에 대한 지연(latency)이 최소화되어야 하는 실시간 시스템
에이전트 수가 제한적이며, 중앙 노드가 병목이 되지 않는 규모의 시스템
이러한 환경에서는 작업 요청, 제안, 협상과 같은 추가적인 통신 과정이 필요 없기 때문에
처리 속도가 빠르고 구현이 단순하다는 장점이 있다.

### CNP(Contract Net Protocol)가 필요한 경우

CNP는 중앙 통제 없이, 에이전트들이 협상을 통해 자율적으로 작업을 분배하는 프로토콜이다.
다음과 같은 상황에서 중앙 스케줄러의 한계를 보완한다.
중앙에서 모든 에이전트의 상태를 완벽하게 파악하기 어려운 경우
에이전트의 능력이나 상태가 동적으로 변화하는 환경
작업 수행 가능 여부를 에이전트 스스로 판단해야 하는 경우
작업 실패 가능성이 존재하며, 재할당이 자주 필요한 시스템
대규모 분산 환경에서 중앙 노드의 병목이나 단일 장애 지점(SPOF)을 피해야 하는 경우
CNP는 통신 비용과 협상 지연이라는 오버헤드가 있지만,
그 대신 유연성, 확장성, 장애 대응 능력을 제공한다.

### 계층형 CNP
계층형 Contract Net Protocol은 CNP의 Manager–Contractor 구조에서 발생하는 의사결정 병목과 네트워크 혼잡을 완화하기 위해 등장하였다. 기존 CNP에서는 하나의 Manager 에이전트가 다수의 Contractor 에이전트와 직접 통신하며 모든 제안을 수집·비교해야 했으나, 계층형 CNP에서는 하나의 최상위 Manager와 여러 하위 Manager 에이전트로 구성된 계층 구조를 도입한다. 하위 Manager 에이전트는 자신이 관리하는 Contractor 에이전트들과 CNP를 수행한 후, 로컬 의사결정 결과 또는 요약된 정보를 최상위 Manager에게 전달함으로써 통신 범위와 의사결정 부담을 분산시킨다.

